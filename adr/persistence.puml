@startuml
queue EventQ as eq
database State as db
eq -> Node : nextEvent
Node -> db : getState
db --> Node : state: HeadState
Node -> HeadLogic: update(state)
HeadLogic --> Node : [st:StateEffect, ot:OtherEffect]
db \\- Node: handle(st)
Other \\- Node : handle(ot)
db -> db: persist(st)
@enduml
